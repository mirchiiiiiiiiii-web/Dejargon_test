<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dejargon - Risk Report</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #212529;
    }
    nav {
      background: white;
      border-bottom: 1px solid #e9ecef;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: #0066cc;
    }
    .nav-links {
      display: flex;
      gap: 2rem;
      align-items: center;
    }
    .nav-links a {
      color: #495057;
      text-decoration: none;
    }
    .nav-buttons {
      display: flex;
      gap: 1rem;
    }
    .btn {
      padding: 0.5rem 1.5rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 500;
      transition: all 0.2s;
    }
    .btn-outline {
      background: white;
      border: 1px solid #dee2e6;
      color: #495057;
    }
    .btn-primary {
      background: #0066cc;
      color: white;
    }
    .btn-primary:hover {
      background: #0052a3;
    }
    .hero {
      max-width: 1200px;
      margin: 4rem auto;
      padding: 0 2rem;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3rem;
      align-items: center;
    }
    .hero-left h1 {
      font-size: 2.5rem;
      line-height: 1.2;
      margin-bottom: 1rem;
      color: #212529;
    }
    .hero-left p {
      color: #6c757d;
      font-size: 1.1rem;
      margin-bottom: 2rem;
    }
    .upload-card {
      background: white;
      border: 2px dashed #dee2e6;
      border-radius: 12px;
      padding: 2rem;
      text-align: center;
    }
    .upload-card p {
      color: #6c757d;
      font-size: 0.95rem;
      margin-bottom: 1.5rem;
    }
    .upload-card .btn {
      width: 100%;
      padding: 0.75rem;
      font-size: 1rem;
    }
    .privacy-note {
      margin-top: 1rem;
      font-size: 0.85rem;
      color: #6c757d;
    }
    .preview-card {
      background: white;
      border: 1px solid #e9ecef;
      border-radius: 12px;
      padding: 2rem;
      height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #adb5bd;
    }
    .scanning-screen {
      max-width: 500px;
      margin: 8rem auto;
      text-align: center;
      padding: 0 2rem;
    }
    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid #e9ecef;
      border-top-color: #0066cc;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 2rem;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .dashboard {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 2rem;
    }
    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }
    .dashboard-header h2 {
      font-size: 1.75rem;
    }
    .dashboard-actions {
      display: flex;
      gap: 1rem;
    }
    .score-display {
      background: white;
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2rem;
      text-align: center;
    }
    .score-number {
      font-size: 3rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }
    .score-green { color: #28a745; }
    .score-yellow { color: #ffc107; }
    .score-orange { color: #fd7e14; }
    .score-red { color: #dc3545; }
    .score-label {
      font-size: 1.25rem;
      color: #6c757d;
    }
    .dashboard-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-bottom: 2rem;
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid #e9ecef;
    }
    .card h3 {
      margin-bottom: 1rem;
      font-size: 1.25rem;
      color: #212529;
    }
    .card p {
      color: #495057;
      line-height: 1.6;
      margin-bottom: 1rem;
    }
    .highlights {
      list-style: none;
      padding-left: 0;
    }
    .highlights li {
      padding: 0.5rem 0;
      color: #495057;
      position: relative;
      padding-left: 1.5rem;
    }
    .highlights li:before {
      content: "â€¢";
      position: absolute;
      left: 0;
      color: #0066cc;
      font-weight: bold;
    }
    .issue-item {
      border-left: 3px solid #dc3545;
      padding-left: 1rem;
      margin-bottom: 1.5rem;
    }
    .issue-item h4 {
      color: #dc3545;
      margin-bottom: 0.5rem;
      font-size: 1rem;
    }
    .issue-item p {
      color: #495057;
      font-size: 0.95rem;
    }
    .clause-item {
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid #e9ecef;
    }
    .clause-item:last-child {
      border-bottom: none;
    }
    .clause-item h4 {
      color: #212529;
      margin-bottom: 0.5rem;
      font-size: 1rem;
    }
    .clause-item p {
      color: #6c757d;
      font-size: 0.9rem;
      line-height: 1.5;
    }
    .full-width {
      grid-column: 1 / -1;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState } = React;

    const mockAnalysisData = {
      score: 65,
      scoreLabel: "Mostly Safe",
      summary: "This contract contains several moderate concerns that should be reviewed. While the core terms are reasonable, there are areas where clarity could be improved to reduce risk exposure.",
      highlights: [
        "Payment terms allow 60-day cycles",
        "Termination clause needs clarification",
        "IP ownership could be more explicit"
      ],
      issues: [
        {
          id: 1,
          title: "Extended Payment Terms",
          description: "The contract specifies payment within 60 days, which is longer than industry standard. This could impact cash flow."
        },
        {
          id: 2,
          title: "Vague Termination Clause",
          description: "Termination conditions are not clearly defined, leaving room for interpretation and potential disputes."
        }
      ],
      clauses: [
        {
          title: "Payment Terms",
          text: "Payment shall be made within 60 days of invoice receipt. Late payments may incur interest charges."
        },
        {
          title: "Intellectual Property",
          text: "All work product created during the engagement shall be subject to the ownership provisions outlined in Schedule A."
        },
        {
          title: "Confidentiality",
          text: "Both parties agree to maintain confidentiality of proprietary information shared during the term of this agreement."
        }
      ]
    };

    function App() {
      const [stage, setStage] = useState("landing");
      const [analysisData, setAnalysisData] = useState(null);

      const handleUpload = async () => {
        const contractText = window.prompt("Paste contract text for analysis:");
        
        if (!contractText || contractText.trim() === "") {
          return;
        }

        setStage("scanning");

        try {
          const response = await fetch("/api/analyze", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({ contractText })
          });

          if (!response.ok) {
            throw new Error(`API error: ${response.status}`);
          }

          const data = await response.json();
          setAnalysisData(data);
          setStage("dashboard");
        } catch (error) {
          console.error("Analysis failed, using mock data:", error);
          setAnalysisData(mockAnalysisData);
          setStage("dashboard");
        }
      };

      const handleNewUpload = () => {
        setStage("landing");
        setAnalysisData(null);
      };

      const handleDownloadReport = () => {
        const report = `DEJARGON RISK REPORT
        
Score: ${analysisData?.score || 0} - ${analysisData?.scoreLabel || "Unknown"}

Summary:
${analysisData?.summary || "No summary available"}

Major Issues:
${(analysisData?.issues || []).map(issue => `- ${issue.title}: ${issue.description}`).join('\n')}

Key Clauses:
${(analysisData?.clauses || []).map(clause => `- ${clause.title}: ${clause.text}`).join('\n')}
`;
        
        const blob = new Blob([report], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "dejargon-risk-report.txt";
        a.click();
        URL.revokeObjectURL(url);
      };

      if (stage === "landing") {
        return <LandingPage onUpload={handleUpload} />;
      }

      if (stage === "scanning") {
        return <ScanningPage />;
      }

      return (
        <DashboardPage 
          data={analysisData} 
          onNewUpload={handleNewUpload}
          onDownload={handleDownloadReport}
        />
      );
    }

    function LandingPage({ onUpload }) {
      return (
        <>
          <nav>
            <div className="logo">Dejargon</div>
            <div className="nav-links">
              <a href="#about">About Us</a>
              <a href="#pricing">Pricing</a>
              <a href="#resources">Resources</a>
            </div>
            <div className="nav-buttons">
              <button className="btn btn-outline">Login</button>
              <button className="btn btn-primary">Get Started</button>
            </div>
          </nav>

          <div className="hero">
            <div className="hero-left">
              <h1>Would You Sign Without Knowing the Risks?</h1>
              <p>Upload your contract and get an instant risk assessment powered by AI.</p>
              
              <div className="upload-card">
                <p>Drop your agreement here or choose a file.<br/>PDF & DOCX only. Max 5MB.</p>
                <button className="btn btn-primary" onClick={onUpload}>
                  Upload your Document
                </button>
                <div className="privacy-note">ðŸ”’ Privacy guaranteed</div>
              </div>
            </div>

            <div className="hero-right">
              <div className="preview-card">
                <div>Contract Preview</div>
              </div>
            </div>
          </div>
        </>
      );
    }

    function ScanningPage() {
      return (
        <div className="scanning-screen">
          <div className="spinner"></div>
          <h2>Scanning your Agreement</h2>
          <p style={{color: '#6c757d', marginTop: '1rem'}}>
            Analyzing contract terms and identifying potential risks...
          </p>
        </div>
      );
    }

    function DashboardPage({ data = {}, onNewUpload, onDownload }) {
      const {
        score = 0,
        scoreLabel = "Unknown",
        summary = "No summary available",
        highlights = [],
        issues = [],
        clauses = []
      } = data;

      const getScoreColor = (score) => {
        if (score >= 75) return "score-green";
        if (score >= 50) return "score-yellow";
        if (score >= 25) return "score-orange";
        return "score-red";
      };

      return (
        <>
          <nav>
            <div className="logo">Dejargon</div>
            <div className="nav-links">
              <a href="#about">About Us</a>
              <a href="#pricing">Pricing</a>
              <a href="#resources">Resources</a>
            </div>
            <div className="nav-buttons">
              <button className="btn btn-outline">Login</button>
              <button className="btn btn-primary">Get Started</button>
            </div>
          </nav>

          <div className="dashboard">
            <div className="dashboard-header">
              <h2>Risk Analysis Report</h2>
              <div className="dashboard-actions">
                <button className="btn btn-outline" onClick={onNewUpload}>
                  Upload New
                </button>
                <button className="btn btn-primary" onClick={onDownload}>
                  Download Report
                </button>
              </div>
            </div>

            <div className="score-display">
              <div className={`score-number ${getScoreColor(score)}`}>
                {score}
              </div>
              <div className="score-label">{scoreLabel}</div>
            </div>

            <div className="dashboard-grid">
              <div className="card">
                <h3>Summary</h3>
                <p>{summary}</p>
                {highlights.length > 0 && (
                  <ul className="highlights">
                    {highlights.map((item, idx) => (
                      <li key={idx}>{item}</li>
                    ))}
                  </ul>
                )}
              </div>

              <div className="card">
                <h3>Major Issues</h3>
                {issues.length === 0 ? (
                  <p>No major issues detected.</p>
                ) : (
                  issues.map(issue => (
                    <div key={issue.id} className="issue-item">
                      <h4>{issue.title}</h4>
                      <p>{issue.description}</p>
                    </div>
                  ))
                )}
              </div>

              <div className="card full-width">
                <h3>Key Clauses</h3>
                {clauses.length === 0 ? (
                  <p>No key clauses identified.</p>
                ) : (
                  clauses.map((clause, idx) => (
                    <div key={idx} className="clause-item">
                      <h4>{clause.title}</h4>
                      <p>{clause.text}</p>
                    </div>
                  ))
                )}
              </div>
            </div>
          </div>
        </>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
